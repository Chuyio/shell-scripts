#!/bin/bash
#
# chkconfig: - 98 02
# description: Starts and stops the your_prog_name daemon.

# Source function library.
. /etc/init.d/functions

# Default variables
prog_name="your_prog_name"
prog_path="/path/to/${prog_name}"
prog_user="your_prog_user"
pidfile="/path/to/${prog_name}.pid"
options="-c your_conf_file"

lockfile="/var/lock/subsys/${prog_name}"

# Check if requirements are met
[ -x "${prog_path}" ] || exit 1
[ -r "${your_conf_file}" ] || exit 1

start(){
  echo -n $"Starting ${prog_name}: "
  daemon --user ${your_prog_user} ${prog_path} ${options}
  retval=$?
  prog_pid=$(pidof ${prog_path})
  [ ! -z "${prog_pid}" ] && echo ${prog_pid} > ${pidfile}
  echo
  [ $retval -eq 0 ] && touch ${lockfile}
  return $retval
}

stop(){
  echo -n $"Stopping ${prog_name}: "
  killproc -p ${pidfile} ${prog_name}
  retval=$?
  echo
  [ $retval -eq 0 ] && rm -f ${lockfile}
  return $retval
}

restart() {
  stop
  start
}

case "$1" in
  start)
    start
    ;;
  stop)
    stop
    ;;
  restart)
    restart
    ;;
  status)
    status -p ${pidfile} ${prog_name}
    ;;
  *)
    echo $"Usage: $0 {start|stop|restart|status}"
    exit 2
esac
exit $?
